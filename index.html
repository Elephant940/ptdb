<!DOCTYPE html>

<head>
    <link rel="icon" loading="lazy"
        href="https://web.archive.org/web/20210131141812if_/http://www.phylopic.org/assets/images/submissions/09af15bc-97ee-4fa0-9379-da7ee328560a.64.png" />
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<style>
    html {
        font-family: Helvetica;
        overflow-x: hidden
    }

    ::-webkit-scrollbar {
        background: rgb(241, 241, 241);
        width: 1vw;
    }

    .entry::-webkit-scrollbar {
        border-radius: 0 0.625rem 0.625rem 0;
        width: 1.25rem;
    }

    ::-webkit-scrollbar-thumb {
        background: rgba(144.75, 144.75, 144.75, 0.5);
    }

    .entry::-webkit-scrollbar-thumb {
        border-radius: 0.625rem;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: rgba(90, 90, 90, 0.5);
    }

    .entry::-webkit-scrollbar-track {
        border-radius: 0.625rem 0 0.625rem 0;
    }

    .header {
        background: rgb(162, 190, 150);
        color: black;
        margin: 0;
        padding: 0.625rem;
        word-break: break-word;
        word-wrap: break-word;
    }

    header {
        font-size: 2.8125rem;
    }

    .credit {
        font-size: 0.75rem;
        margin-right: 0
    }

    a {
        color: #3d90c8;
    }

    a:visited {
        color: #523dc8;
    }

    .favicon {
        font-size: 0.75rem;
        margin: 0.625rem;
        word-break: break-word;
        word-wrap: break-word;
    }

    body {
        background: white;
        margin: 0;
        padding: 0;
        word-break: break-word;
        word-wrap: break-word;
    }

    .summary {
        margin: 0.625rem;
    }

    #counter {
        background-color: rgb(162, 190, 150);
        display: inline-block;
        font-size: 1rem;
    }

    #searchBar {
        border: 1px solid #eaeaea;
        border-radius: 0.625rem;
        display: block;
        font-size: 1rem;
        min-height: 2rem;
        justify-self: center;
        margin: auto;
        padding: 0.3125rem 0.625rem;
        width: 41.2057878vw;
        
    }

    .mytabs {
        background: rgb(237, 227, 214);
        display: flex;
        flex-wrap: wrap;
        margin: 0;
        padding: 0;
        text-align: center;
    }

    .mytabs input[type="radio"] {
        display: none;
    }

    .mytabs input[type='radio']:checked+label+.tab {
        display: block;
    }

    .mytabs input[type="radio"]:checked+label {
        background: rgb(237, 227, 214);
    }

    .mytabs label {
        background: rgb(221, 202, 174);
        /* border-radius: 2.5rem 2.5rem 0 0; */
        display: block;
        font-size: 1.5rem;
        font-weight: bold;
        padding: 0.625rem 0;
        width: 20%;
    }

    .tab {
        display: none;
        margin: 0;
        order: 1;
        padding: 0;
        text-align: center;
        background: rgb(237, 227, 214);
    }

    .period {
        align-content: flex-start;
        background: rgb(237, 227, 214);
        display: flex;
        flex-wrap: wrap;
        min-height: 100vh;
        margin: auto;
        padding: 0.625rem;
    }

    .entry {
        background-color: rgb(255, 255, 255);
        border-radius: 1.25rem;
        box-sizing: border-box;
        flex: 1 1 26.9589rem;
        margin: 0.625rem;
        max-height: calc(92.5ch - 1.25rem);
        max-width: calc(50vw - 1.25rem);
        overflow-x: auto;
        text-align: left;
        width: 100%;
    }

    .entry:hover {
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
    }

    .entry-heading {
        background-color: rgb(230, 230, 230);
        box-sizing: border-box;
        margin-bottom: 0.625rem;
        object-fit: fill;
        padding: 1.25rem 1.25rem 0.625rem 1.25rem;
        position: sticky;
        text-align: left;
        top: 0;
        width: 100%;
    }

    .title {
        border-radius: 1.5625rem;
        font-size: 1.125rem;
        font-weight: bold;
        margin: 0;
    }

    .medium {
        font-size: 0.9375rem;
        margin: 0;
    }

    .heading {
        margin-left: 0;
        padding: 0.625rem 1.25rem 0.625rem 1.25rem;
    }

    .info {
        margin: 0 0.625rem 0.3125rem 0;
    }

    .refs {
        margin-top: 0;
        padding-left: 1.5625rem;
        text-indent: -1.5625rem;
    }

    ul:nth-last-child(1) {
        padding-bottom: 0.625rem;
    }

    @media screen and (max-width: 23.75rem) {
        .mytabs label {
            font-size: 4.25vw;
        }

        #searchBar {
            width: 66vw
        }
    }

    @media screen and (max-width: 58.25rem) {

        .entry {
            max-height: calc(185ch - 1.25rem);
            max-width: 100vw;
        }

        #searchBar {
            width: 41.25vw
        }
    }
</style>


<title>Proboscidean Text Database</title>
<div class="header">
    <header><b>The Proboscidean Text Database</b></header>
    <div class="medium">Created by Trent Grasso (tjgrasso940@gmail.com)<br>Technical assistance provided by Owen
        Schwartz (oschwartz10612@gmail.com)</div>
</div>

<div class="summary">
    The Proboscidean Text Database (PTDb) is a digital collection of resources about the Proboscidea,
    the evolutionary group comprising elephants, mammoths, mastodons, and their relatives. All catalogued sources have been saved in Internet Archive's <a href="https://web.archive.org/"target="_blank">Wayback Machine</a>, so if any are unavailable they should be accessible there.
    <br>
    Sources catalogued: <div id="counter"></div>
</div>

<div id="searchWrapper">
    <input type="text" name="searchBar" id="searchBar" placeholder="Search in the current tab..." />

    <div class="favicon">Favicon: African forest elephant (<i>Loxodonta cyclotis</i>), credit to <a href="http://www.phylopic.org/image/09af15bc-97ee-4fa0-9379-da7ee328560a/" target="_blank">Richard Ruggiero and Zimices on PhyloPic</a>.</div>

    <body>
        <div class="mytabs">
            <input type="radio" id="B1700" name="mytabs" checked="checked" onClick="clearSearchBar();searchArray = B1700; currentTab = this.id + '_table';">
            <label for="B1700" style=border-left-width:0px;>Before 1700</label>
            <div class="tab">
                <div class="period" id="B1700_table"></div>
            </div>
            <input type="radio" id="D1700-1799" name="mytabs" onClick="clearSearchBar(); searchArray = D1700_1799; currentTab = this.id + '_table';">
            <label for="D1700-1799">1700-1799</label>
            <div class="tab">
                <div class="period" id="D1700-1799_table"></div>
            </div>
            <input type="radio" id="D1800-1899" name="mytabs" onClick="clearSearchBar(); searchArray = D1800_1899; currentTab = this.id + '_table';">
            <label for="D1800-1899">1800-1899</label>
            <div class="tab">
                <div class="period" id="D1800-1899_table"></div>
            </div>
            <input type="radio" id="D1900-1999" name="mytabs" onClick="clearSearchBar(); searchArray = D1900_1999; currentTab = this.id + '_table';">
            <label for="D1900-1999">1900-1999</label>
            <div class="tab">
                <div class="period" id="D1900-1999_table"></div>
            </div>
            <input type="radio" id="D2000-2021" name="mytabs" onClick="clearSearchBar(); searchArray = D2000_2021; currentTab = this.id + '_table'">
            <label for="D2000-2021" style=border-right-width:0px;>2000-2021</label>
            <div class="tab">
                <div class="period" id="D2000-2021_table"></div>
            </div>
        </div>

    </body>


    <script>
        getAllPeriods()
        var counter = document.getElementById('counter')
        var currentTab = 'B1700_table'
        var B1700 = []
        var D1700_1799 = []
        var D1800_1899 = []
        var D1900_1999 = []
        var D2000_2021 = []
        var searchArray = []
        
        searchBar.addEventListener('keyup', (e) => {
            if (e.target.value.length > 2 || e.target.value.length == 0) { 
            console.log(e.target.value);
            const searchString = e.target.value.toLowerCase();

            const filteredPeriod = searchArray.filter((row) => {
                return (
                    row.contributors.toLowerCase().includes(searchString) ||
                    row.date.toLowerCase().includes(searchString) ||
                    row.languages.toLowerCase().includes(searchString) ||
                    row.location.toLowerCase().includes(searchString) ||
                    row.summary.toLowerCase().includes(searchString) ||
                    row.title.toLowerCase().includes(searchString)
                );
            });
            console.log(filteredPeriod);
            buildCards(filteredPeriod, currentTab)
        }});

        function clearSearchBar() {
            searchBar.value = ''
            buildCards(searchArray, currentTab)
        }

        function goToSource(tab, source, eyedee) {
            document.getElementById(tab).checked = true;
            document.getElementById(source).scrollIntoView();
            document.getElementById(eyedee).style.color = "#523dc8"
        }

        async function getAllPeriods() {
            B1700, searchArray = await getPeriod('B1700_table', 'B1700')
            D1700_1799 = await getPeriod('D1700-1799_table', 'D1700-1799')
            D1800_1899 = await getPeriod('D1800-1899_table', 'D1800-1899')
            D1900_1999 = await getPeriod('D1900-1999_table', 'D1900-1999')
            D2000_2021 = await getPeriod('D2000-2021_table', 'D2000-2021')
            counter.innerHTML = B1700.length + D1700_1799.length + D1800_1899.length + D1900_1999.length + D2000_2021.length
        }

        async function getPeriod(id, endpoint) {
            var myPeriod = await fetch(`/api/v1/${endpoint}`);
            myPeriod = await myPeriod.json();
            buildCards(myPeriod, id)
            console.log(myPeriod)
            return myPeriod
        }

        function buildCards(data, id) {
            var card = document.getElementById(id)
            card.innerHTML = ''
            for (var i = 0; i < data.length; i++) {
                var row =
                    `   <div class="entry" >
                    <div class="entry-heading" id=${data[i].eyedee}>
                    <p class="title">${data[i].title}</p>
                    <p class="medium">${data[i].medium}</p>
                    </div>
                    <u class="heading">Contributor(s)</u>
                    <ul class="info">${data[i].contributors}</ul>
                    <u class="heading">Publication date</u>
                    <ul class="info">${data[i].date}</ul>
                    <u class="heading">Duration</u>
                    <ul class="info">${data[i].duration}</ul>
                    <u class="heading">Publisher</u>
                    <ul class="info">${data[i].publisher}</ul>
                    <u class="heading">Publication location</u>
                    <ul class="info">${data[i].location}</ul>
                    <u class="heading">Language(s)</u>
                    <ul class="info">${data[i].languages}</ul>`

                if (data[i].container != undefined) {
                    row +=
                        `<u class="heading">Container</u>
                            <ul class="info">${data[i].container}</ul>`
                }

                if (data[i].iteration != undefined) {
                    row +=
                        `<u class="heading">Iteration</u>
                            <ul class="info">${data[i].iteration}</ul>`
                }

                row +=
                    `<u class="heading">Summary and significance</u>
                            <ul class="info">${data[i].summary}</ul>
                        <u class="heading">Link(s) to source</u>
                            <ul class="info">${data[i].links}</ul>`

                if (data[i].notes != undefined) {
                    row +=
                        `<u class="heading">Notes</u>
                            <ul class="info">${data[i].notes}</ul>`
                }

                if (data[i].references != undefined) {
                    row +=
                        `<u class="heading">References</u>
                    <ul class="info">${data[i].references}</ul>`
                }
                row +=
                    `</div>`

                card.innerHTML += row
            }

        }

    </script>